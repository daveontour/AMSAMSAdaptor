<?xml version="1.0" encoding="utf-8" ?>
<config>
	<FromAMSQueue>.\private$\fromamstoadani</FromAMSQueue>
	<ToAMSRequestQueue>.\private$\fromamstoadani</ToAMSRequestQueue>
	<ReadMessageLoopInterval>10</ReadMessageLoopInterval>
	<FromToken>32b8ef7a-0a16-4b4a-9e01-799960c91e0e</FromToken>
	<ToToken>32b8ef7a-0a16-4b4a-9e01-799960c91e0e</ToToken>
	<AirportCode>IXE</AirportCode>
	<FromAMSWebServiceURL>http://localhost:9191/SITAAMSIntegrationService/v2/SITAAMSIntegrationService/</FromAMSWebServiceURL>
	<ToAMSWebServiceURL>http://localhost:9191/SITAAMSIntegrationService/v2/SITAAMSIntegrationService/</ToAMSWebServiceURL>
	<StartFromHours>-1000</StartFromHours>
	<StartFromHours>24</StartFromHours>

	<InitAircraftTypes>true</InitAircraftTypes>
	<InitAircraft>true</InitAircraft>
	<InitAirports>true</InitAirports>
	<InitAirlines>true</InitAirlines>

	<ProcessMessages>
		<Message>FlightUpdatedNotification</Message>
		<Message>FlightCreatedNotification</Message>
		<Message>FlightDeletedNotification</Message>	
		<!-- Not a message type, but we need a handler for "Flight" when an initial load is done on startup-->
		<Message>Flight</Message>
	</ProcessMessages>
	
	<HandlerFlightUpdate>
		<PassFilter>.//ams:FlightId/ams:AirlineDesignator[@codeContext='IATA' and  contains(text(), 'EK')]</PassFilter>
		<PassFilter>.//ams:FlightId/ams:AirlineDesignator[@codeContext='IATA' and  contains(text(), 'QF')]</PassFilter>
		<NoPassFilter>.//ams:FlightId/ams:AirlineDesignator[@codeContext='IATA' and  contains(text(), 'QR')]</NoPassFilter>
		<Transformer>
			<TransformerClass>TransformerFlightRemoveProperties</TransformerClass>
			<TransformerConfig>
				<Property propertyName="S---_AlternateRemark2"/>
				<Property propertyName="S---_AlternateRemark1"/>
			</TransformerConfig>
		</Transformer>
		<Transformer>
			<TransformerClass>TransformerFlightAddProperties</TransformerClass>
			<TransformerConfig>
				<Property propertyName="OriginalFlightNature" type="alternateProperty" alternatePropertyName="Nature" />
				<Property propertyName="TimeMessageReceived" type="dateTime" dateTimeFormat="HH:mm:ss" />
				<Property propertyName="TargetAirport" type="fixed" value="HEL" />
			</TransformerConfig>
		</Transformer>
        <Transformer>
			<TransformerClass>TransformerFlightReMapper</TransformerClass>
			<TransformerConfig>
				<Property propertyName="S---_LastArrivalSource" type="alternateProperty" alternatePropertyName="S---_LastArrivalSource_AltSource" />
				<Property propertyName="Nature" type="fixed" value="Arrival" />
				<Property propertyName="AirportIATA" type="fixed" value="DJB" />
			</TransformerConfig>
		</Transformer>		
	</HandlerFlightUpdate>
	<HandlerFlightCreate>
		<PassFilter>.//ams:FlightId/ams:AirlineDesignator[@codeContext='IATA' and  contains(text(), 'QF')]</PassFilter>
	</HandlerFlightCreate>
	
	<!-- Handler for flight on initial population -->
	<HandlerFlight>
		<PassFilter>.//ams:FlightId/ams:AirlineDesignator[@codeContext='IATA' and  contains(text(), 'EK')]</PassFilter>
		<PassFilter>.//ams:FlightId/ams:AirlineDesignator[@codeContext='IATA' and  contains(text(), 'QF')]</PassFilter>
		<NoPassFilter>.//ams:FlightId/ams:AirlineDesignator[@codeContext='IATA' and  contains(text(), 'QR')]</NoPassFilter>
	</HandlerFlight>
</config>
